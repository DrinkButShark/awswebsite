// === Courses Data ===
const courses = [
  {
    title: "Move from Graphic Designer to UX Designer – Class 1",
    instructor: "Herman Wong",
    status: "ongoing",
    img: "https://images.unsplash.com/photo-1606761568499-6b87f8a75d5f?w=600",
    youtube: "https://youtu.be/n-WhBN6GY0E?si=kGXgVA0DmeYANv0s",
    students: "8/10",
    date: "Dec 10",
    location: "HCMC"
  },
  {
    title: "Introduction to Data Science",
    instructor: "Jane Doe",
    status: "ongoing",
    img: "https://images.unsplash.com/photo-1581091870629-93f2dbeb0d62?w=600",
    youtube: "https://www.youtube.com/watch?v=5qap5aO4i9A",
    students: "12/15",
    date: "Jan 5",
    location: "Online"
  },
  {
    title: "Python for Data Analysis",
    instructor: "Alice Johnson",
    status: "completed",
    img: "https://images.unsplash.com/photo-1581091012184-d96e0184f0c6?w=600",
    youtube: "https://youtu.be/CSbMuFk2xe0?si=Ni0OOxsDIJMToYXB",
    students: "20/20",
    date: "Feb 1",
    location: "HCMC"
  },
  {
    title: "Introduction to Data Science",
    instructor: "Jane Doe",
    status: "ongoing",
    img: "https://images.unsplash.com/photo-1581091870629-93f2dbeb0d62?w=600",
    youtube: "https://www.youtube.com/watch?v=5qap5aO4i9A",
    students: "12/15",
    date: "Jan 5",
    location: "Online"
  },
  {
    title: "Python for Data Analysis",
    instructor: "Alice Johnson",
    status: "completed",
    img: "https://images.unsplash.com/photo-1581091012184-d96e0184f0c6?w=600",
    youtube: "https://youtu.be/CSbMuFk2xe0?si=Ni0OOxsDIJMToYXB",
    students: "20/20",
    date: "Feb 1",
    location: "HCMC"
  },

  {
    title: "Move from Graphic Designer to UX Designer – Class 1",
    instructor: "Herman Wong",
    status: "ongoing",
    img: "https://images.unsplash.com/photo-1606761568499-6b87f8a75d5f?w=600",
    youtube: "https://youtu.be/n-WhBN6GY0E?si=kGXgVA0DmeYANv0s",
    students: "8/10",
    date: "Dec 10",
    location: "HCMC"
  },
    {
    title: "Move from Graphic Designer to UX Designer – Class 1",
    instructor: "Herman Wong",
    status: "ongoing",
    img: "https://images.unsplash.com/photo-1606761568499-6b87f8a75d5f?w=600",
    youtube: "https://youtu.be/n-WhBN6GY0E?si=kGXgVA0DmeYANv0s",
    students: "8/10",
    date: "Dec 10",
    location: "HCMC"
  },
  {
    title: "Introduction to Data Science",
    instructor: "Jane Doe",
    status: "ongoing",
    img: "https://images.unsplash.com/photo-1581091870629-93f2dbeb0d62?w=600",
    youtube: "https://www.youtube.com/watch?v=5qap5aO4i9A",
    students: "12/15",
    date: "Jan 5",
    location: "Online"
  },
  {
    title: "Python for Data Analysis",
    instructor: "Alice Johnson",
    status: "completed",
    img: "https://images.unsplash.com/photo-1581091012184-d96e0184f0c6?w=600",
    youtube: "https://youtu.be/CSbMuFk2xe0?si=Ni0OOxsDIJMToYXB",
    students: "20/20",
    date: "Feb 1",
    location: "HCMC"
  },
  {
    title: "Introduction to Data Science",
    instructor: "Jane Doe",
    status: "ongoing",
    img: "https://images.unsplash.com/photo-1581091870629-93f2dbeb0d62?w=600",
    youtube: "https://www.youtube.com/watch?v=5qap5aO4i9A",
    students: "12/15",
    date: "Jan 5",
    location: "Online"
  },
  {
    title: "Python for Data Analysis",
    instructor: "Alice Johnson",
    status: "completed",
    img: "https://images.unsplash.com/photo-1581091012184-d96e0184f0c6?w=600",
    youtube: "https://youtu.be/CSbMuFk2xe0?si=Ni0OOxsDIJMToYXB",
    students: "20/20",
    date: "Feb 1",
    location: "HCMC"
  },

  {
    title: "Move from Graphic Designer to UX Designer – Class 1",
    instructor: "Herman Wong",
    status: "ongoing",
    img: "https://images.unsplash.com/photo-1606761568499-6b87f8a75d5f?w=600",
    youtube: "https://youtu.be/n-WhBN6GY0E?si=kGXgVA0DmeYANv0s",
    students: "8/10",
    date: "Dec 10",
    location: "HCMC"
  },
    {
    title: "Move from Graphic Designer to UX Designer – Class 1",
    instructor: "Herman Wong",
    status: "ongoing",
    img: "https://images.unsplash.com/photo-1606761568499-6b87f8a75d5f?w=600",
    youtube: "https://youtu.be/n-WhBN6GY0E?si=kGXgVA0DmeYANv0s",
    students: "8/10",
    date: "Dec 10",
    location: "HCMC"
  },
  {
    title: "Introduction to Data Science",
    instructor: "Jane Doe",
    status: "ongoing",
    img: "https://images.unsplash.com/photo-1581091870629-93f2dbeb0d62?w=600",
    youtube: "https://www.youtube.com/watch?v=5qap5aO4i9A",
    students: "12/15",
    date: "Jan 5",
    location: "Online"
  },
  {
    title: "Python for Data Analysis",
    instructor: "Alice Johnson",
    status: "completed",
    img: "https://images.unsplash.com/photo-1581091012184-d96e0184f0c6?w=600",
    youtube: "https://youtu.be/CSbMuFk2xe0?si=Ni0OOxsDIJMToYXB",
    students: "20/20",
    date: "Feb 1",
    location: "HCMC"
  },
  {
    title: "Introduction to Data Science",
    instructor: "Jane Doe",
    status: "ongoing",
    img: "https://images.unsplash.com/photo-1581091870629-93f2dbeb0d62?w=600",
    youtube: "https://www.youtube.com/watch?v=5qap5aO4i9A",
    students: "12/15",
    date: "Jan 5",
    location: "Online"
  },
  {
    title: "Python for Data Analysis",
    instructor: "Alice Johnson",
    status: "completed",
    img: "https://images.unsplash.com/photo-1581091012184-d96e0184f0c6?w=600",
    youtube: "https://youtu.be/CSbMuFk2xe0?si=Ni0OOxsDIJMToYXB",
    students: "20/20",
    date: "Feb 1",
    location: "HCMC"
  },


];

// NEW: sample PDFs dataset (ensure each pdf has an href; download will use name)
const pdfs = [
  {
    name: "Wedding Planner List.Doc",
    owners: ["Alice Johnson"],
    lastModified: "Sep 9, 2019 • 4:30 AM",
    size: "1.2 MB",
    icon: "fa-file-word",
    href: "files/Wedding-Planner-List.doc" // replace with real file path or URL
  }

];

// === Helper: normalize YouTube link to embed ===
function getYouTubeEmbed(url) {
  try {
    const u = new URL(url);
    const host = u.hostname.toLowerCase();
    let id = null;
    if (host.includes('youtu.be')) id = u.pathname.slice(1);
    else if (host.includes('youtube.com')) id = u.searchParams.get('v') || u.pathname.split('/embed/')[1];
    if (id) return `https://www.youtube.com/embed/${id}?rel=0&modestbranding=1`;
  } catch(e){}
  return null;
}

// === Render Courses ===
const courseGrid = document.getElementById('courseGrid');
function renderCourses(filter = 'all') {
  courseGrid.innerHTML = '';
  courses.forEach(course => {
    if(filter === 'all' || course.status === filter){
      const col = document.createElement('div');
      col.className = 'col-12 col-md-6 col-lg-4 course-card';
      col.dataset.status = course.status;

      let mediaContent = '';
      if(course.youtube){
        const embedUrl = getYouTubeEmbed(course.youtube);
        if(embedUrl) mediaContent = `<div class="ratio ratio-16x9"><iframe src="${embedUrl}" title="${course.title}" allowfullscreen loading="lazy"></iframe></div>`;
        else mediaContent = `<img src="${course.img}" class="card-img-top" alt="Course">`;
      } else mediaContent = `<img src="${course.img}" class="card-img-top" alt="Course">`;

      col.innerHTML = `
        <div class="card shadow-sm border-0 h-100">
          ${mediaContent}
          <div class="card-body">
            <h5 class="card-title fw-semibold">${course.title}</h5>
            <p class="text-muted mb-2">
              <span class="instructor-label">Instructor:</span>
              <span class="instructor-name">${course.instructor}</span>
            </p>
            <div class="d-flex justify-content-between small text-muted">
              <span><i class="fa-regular fa-user me-1"></i>${course.students}</span>
              <span><i class="fa-regular fa-calendar me-1"></i>${course.date}</span>
              <span><i class="fa-solid fa-location-dot me-1"></i>${course.location}</span>
            </div>
          </div>
        </div>
      `;
      courseGrid.appendChild(col);
    }
  });
}

// UPDATED: render a table-like PDF list with Actions (download) column
// Updated renderPDFs: use .row/.col classes inside header and each list item so columns align correctly
// ...existing code...
function renderPDFs() {
  if (!courseGrid) return;
  courseGrid.innerHTML = `
    <div class="col-12">
      <div class="pdf-list card shadow-sm border-0">
        <div class="pdf-list-header d-none d-md-block px-3 py-2 small text-muted">
          <div class="row g-0 align-items-center">
            <div class="col-md-5">Name</div>
            <div class="col-md-3">Owners</div>
            <div class="col-md-2">Last modified</div>
            <div class="col-md-1 text-start">File size</div>
            <div class="col-md-1 text-start">Actions</div>
          </div>
        </div>

        <div class="list-group list-group-flush pdf-list-body">
          ${pdfs.map(pdf => `
            <div class="list-group-item px-3 py-2">
              <div class="row g-0 align-items-center">
                <div class="col-12 col-md-5 d-flex align-items-center gap-3">
                  <i class="fa ${pdf.icon} fa-lg text-primary"></i>
                  <a href="${pdf.href}" class="pdf-name text-decoration-none" target="_blank" rel="noopener">${pdf.name}</a>
                </div>

                <div class="col-12 col-md-3 d-none d-md-flex align-items-center">
                  <div class="owners">
                    ${pdf.owners.map(o => `<span class="owner-badge" title="${o}">${o[0]}</span>`).join(' ')}
                  </div>
                </div>

                <div class="col-12 col-md-2 d-none d-md-flex text-muted">
                  ${pdf.lastModified}
                </div>

                <div class="col-6 col-md-1 text-muted text-md-start">
                  ${pdf.size}
                </div>

                <div class="col-6 col-md-1 text-end pdf-actions" style="display: flex; justify-content: start; gap: 0.5rem;">
                  <a class="btn btn-sm btn-outline-primary" href="${pdf.href}" download="${pdf.name}" aria-label="Download ${pdf.name}">
                    <i class="fa fa-download"></i>
                  </a>
                  <a class="btn btn-sm btn-primary" href="${pdf.href}" target="_blank" rel="noopener" aria-label="View ${pdf.name}">
                    <i class="fa fa-eye"></i>
                  </a>
                </div>
              </div>
            </div>
          `).join('')}
        </div>
      </div>
    </div>
  `;
}
// Update tab click handler to support 'pdfs'
const tabs = document.querySelectorAll('#courseTabs .nav-link');
tabs.forEach(tab => {
  tab.addEventListener('click', e => {
    e.preventDefault();
    tabs.forEach(t => t.classList.remove('active'));
    tab.classList.add('active');

    const filter = tab.getAttribute('data-tab') || 'all';
    if (filter === 'pdfs') {
      renderPDFs();
    } else {
      renderCourses(filter);
    }
  });
});

// === Theme Toggle + Save Preference ===
const themeToggle = document.getElementById('themeToggle');
if(themeToggle){
  const icon = themeToggle.querySelector('i');
  if(localStorage.getItem('theme') === 'dark') document.body.classList.add('dark-theme');
  if(document.body.classList.contains('dark-theme')) icon.classList.replace('fa-moon','fa-sun');

  themeToggle.addEventListener('click', ()=>{
    document.body.classList.toggle('dark-theme');
    icon.classList.toggle('fa-moon');
    icon.classList.toggle('fa-sun');
    localStorage.setItem('theme', document.body.classList.contains('dark-theme') ? 'dark':'light');
  });
}

// === Initial Render ===
renderCourses('all');

// === Search Input Animation ===
const searchInput = document.querySelector('.search-box input');
if(searchInput){
  searchInput.addEventListener('focus', ()=> searchInput.style.width = window.innerWidth<768?'220px':'380px');
  searchInput.addEventListener('blur', ()=> searchInput.style.width = window.innerWidth<768?'180px':'300px');
}


// === Initialize Vanta.js Waves ===
VANTA.WAVES({
  el: "#animated-bg",
  mouseControls: true,
  touchControls: true,
  minHeight: 200.00,
  minWidth: 200.00,
  scale: 1.0,
  scaleMobile: 1.0,
  color: 0x6f42c1,
  shininess: 50.00,
  waveHeight: 20.00,
  waveSpeed: 0.5,
  zoom: 0.9
});

// === Initialize Particles.js Floating Dots ===
tsParticles.load("particles-js", {
  particles: {
    number: { value: 40 },
    color: { value: "#6f42c1" },
    shape: { type: "circle" },
    opacity: { value: 0.5 },
    size: { value: 3 },
    move: { enable: true, speed: 1 }
  },
  interactivity: {
    events: { onhover: { enable: true, mode: "repulse" } }
  }
});